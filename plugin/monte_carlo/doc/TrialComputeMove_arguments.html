

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TrialComputeMove &mdash; FEASST 0.25.8 0.25.8 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=fb4e371e"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js"></script>
      <script src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
      <script src="../../../_static/leave_notice.js?v=db0899f3"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />

	<!-- frame blocking -->
	<script type="text/javascript">
		if (top !=self) {
			top.location=self.location;
		}
	</script>

	<!-- NIST header and footer -->
	<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            FEASST 0.25.8
          </a>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../OVERVIEW.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/README.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../text_interface.html">Text Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../particle/README.html">Particle files and units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">C++ Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example/README.html">Modify FEASST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pyfeasst/README.html">pyfeasst</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../python/README.html">Python Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../CONTACT.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/sphinx/CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/sphinx/ACKNOWLEDGEMENT.html">Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/sphinx/CITATION.html">Citation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">FEASST 0.25.8</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <header class="nist-header" id="nist-header" role="banner">

  <a href="https://www.nist.gov/" title="National Institute of Standards and Technology" class="nist-header__logo-link" rel="home">
    <svg aria-hidden="true" class="nist-header__logo-icon" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="32" viewBox="0 0 24 32">
      <path d="M20.911 5.375l-9.482 9.482 9.482 9.482c0.446 0.446 0.446 1.161 0 1.607l-2.964 2.964c-0.446 0.446-1.161 0.446-1.607 0l-13.25-13.25c-0.446-0.446-0.446-1.161 0-1.607l13.25-13.25c0.446-0.446 1.161-0.446 1.607 0l2.964 2.964c0.446 0.446 0.446 1.161 0 1.607z"></path>
    </svg>
    <svg class="nist-header__logo-image" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="-237 385.7 109.7 29.3">
      <title>National Institute of Standards and Technology</title>
      <g>
        <path class="st0" d="M-231,415h-6v-23.1c0,0,0-4.4,4.4-5.8c4-1.3,6.6,1.3,6.6,1.3l19.7,21.3c1,0.6,1.4,0,1.4-0.6v-22h6.1V409
          c0,1.9-1.6,4.4-4,5.3c-2.4,0.9-4.9,0.9-7.9-1.7l-18.5-20c-0.5-0.5-1.8-0.6-1.8,0.4L-231,415L-231,415z"/>
        <path class="st0" d="M-195,386.1h6.1v20.7c0,2.2,1.9,2.2,3.6,2.2h26.8c1.1,0,2.4-1.3,2.4-2.7c0-1.4-1.3-2.8-2.5-2.8H-176
          c-3,0.1-9.2-2.7-9.2-8.5c0-7.1,5.9-8.8,8.6-9h49.4v6.1h-12.3V415h-6v-22.9h-30.2c-2.9-0.2-4.9,4.7-0.2,5.4h18.6
          c2.8,0,7.4,2.4,7.5,8.4c0,6.1-3.6,9-7.5,9H-185c-4.5,0-6.2-1.1-7.8-2.5c-1.5-1.5-1.7-2.3-2.2-5.3L-195,386.1
          C-194.9,386.1-195,386.1-195,386.1z"/>
      </g>
    </svg>
  </a>

</header>

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>TrialComputeMove</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="trialcomputemove">
<h1>TrialComputeMove<a class="headerlink" href="#trialcomputemove" title="Link to this heading"></a></h1>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N6feasst16TrialComputeMoveE">
<span class="target" id="classfeasst_1_1TrialComputeMove"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TrialComputeMove</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><a class="reference internal" href="../../charge/doc/utils.html#_CPPv46feasst" title="feasst"><span class="n"><span class="pre">feasst</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="TrialCompute.html#_CPPv4N6feasst12TrialComputeE" title="feasst::TrialCompute"><span class="n"><span class="pre">TrialCompute</span></span></a><br /></dt>
<dd><p>Move a selection of particles and sites.</p>
<p>Derivation of the acceptance criteria follows Lecture 9 of Prof. David Kofke’s Molecular Simulation course CE 530.</p>
<p><a class="reference external" href="http://www.eng.buffalo.edu/~kofke/ce530/Lectures/lectures.html">http://www.eng.buffalo.edu/~kofke/ce530/Lectures/lectures.html</a></p>
<p>For this type of move, the potential energy of the system, U, is the only thermodynamic variable which changes. Thus, whether in the canonical ensemble or otherwise, the probability distribution,</p>
<p><p><span class="math notranslate nohighlight">\(\pi_i \propto \exp(-\beta U_i)\)</span></p>
<p>because the other thermodynamic variables such as number of particles,
or volume do not change.</p>
<p>The following table describes the transition probabilities associated with
the chosen trial move, and its reverse trial that is considered for the
purpose of satisfying detailed balance.
Thus, the probability shown represents the probability of transitioning from
the old to the new state, <span class="math notranslate nohighlight">\(\pi_{on}\)</span>.
And the reverse transition probability is from new to old, <span class="math notranslate nohighlight">\(\pi_{no}\)</span>.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Forward event</p>
<p>[reverse event]</p>
</td>
<td><p>Probability, <span class="math notranslate nohighlight">\(\pi_{on}\)</span></p>
<p>[reverse probability, <span class="math notranslate nohighlight">\(\pi_{no}\)</span>]</p>
</td>
</tr>
<tr class="row-even"><td><p>Select particle of type t</p>
<p>[Select particle of type t]</p>
</td>
<td><p><span class="math notranslate nohighlight">\(1/N_t\)</span></p>
<p><span class="math notranslate nohighlight">\([1/N_t]\)</span></p>
</td>
</tr>
<tr class="row-odd"><td><p>Move to new position</p>
<p>[Move to old position]</p>
</td>
<td><p><span class="math notranslate nohighlight">\(1/v\)</span></p>
<p><span class="math notranslate nohighlight">\([1/v]\)</span></p>
</td>
</tr>
<tr class="row-even"><td><p>Accept</p>
<p>[Accept]</p>
</td>
<td><p><span class="math notranslate nohighlight">\(\min(1, \chi)\)</span></p>
<p><span class="math notranslate nohighlight">\([\min(1, 1/\chi)]\)</span></p>
</td>
</tr>
</tbody>
</table>
<p>where <span class="math notranslate nohighlight">\(\chi\)</span> is the acceptance probability that we can now derive by
imposing the (local) detailed balance condition.</p>
<p>For (local) detailed balance, the probability of being in the old state,
<span class="math notranslate nohighlight">\(\pi_o\)</span>, times the probability of transitioning from the old to the new
state, <span class="math notranslate nohighlight">\(\pi_{on}\)</span>, should be equal to the probability of being in the new
state, <span class="math notranslate nohighlight">\(\pi_n\)</span> times the probability of transitioning from the new to old
state, <span class="math notranslate nohighlight">\(\pi_{no}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\pi_o \pi_{on} = \pi_n \pi_{no}\)</span></p>
<p>Substituting the probability distribution and transition probabilities yields</p>
<p><span class="math notranslate nohighlight">\(\frac{\min(1, \chi)\exp(-\beta U_o)}{N_t v} =
\frac{\min(1, 1/\chi)\exp(-\beta U_n)}{N_t v}\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{\min(1, \chi)}{\min(1, 1/\chi)} = \exp[-\beta(U_n - U_o)] =
\exp(-\beta\Delta U)\)</span></p>
<p>The left hand side is <span class="math notranslate nohighlight">\(\chi\)</span> for both cases of <span class="math notranslate nohighlight">\(\chi &lt;= 1\)</span>
and <span class="math notranslate nohighlight">\(\chi &gt; 1\)</span>. Thus,</p>
<p><span class="math notranslate nohighlight">\(\chi = \exp(-\beta\Delta U)\)</span></p>
<p>For configurational bias, consider multiple trial positions and select one.
This can lead to higher acceptance probability or larger displacements,
<span class="math notranslate nohighlight">\(\delta\)</span>, in each of D dimensions.
It is also parallelizable (<a class="reference external" href="https://doi.org/10.1103/PhysRevE.51.1560">https://doi.org/10.1103/PhysRevE.51.1560</a>)
and allows the use of dual-cut CB (<a class="reference external" href="https://doi.org/10.1080/002689798167881">https://doi.org/10.1080/002689798167881</a>).</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Forward event</p>
<p>[reverse event]</p>
</td>
<td><p>Probability, <span class="math notranslate nohighlight">\(\pi_{on}\)</span></p>
<p>[reverse probability, <span class="math notranslate nohighlight">\(\pi_{no}\)</span>]</p>
</td>
</tr>
<tr class="row-even"><td><p>Select particle of type t</p>
<p>[Select particle of type t]</p>
</td>
<td><p><span class="math notranslate nohighlight">\(1/N_t\)</span></p>
<p><span class="math notranslate nohighlight">\([1/N_t]\)</span></p>
</td>
</tr>
<tr class="row-odd"><td><p>Generate k positions about
<span class="math notranslate nohighlight">\(x_o\)</span>.
Probability <span class="math notranslate nohighlight">\(x_n\)</span> is in k.</p>
<p>[Generate j positions about
<span class="math notranslate nohighlight">\(x_n\)</span>.
Probability <span class="math notranslate nohighlight">\(x_o\)</span> is in j.]</p>
</td>
<td><p><span class="math notranslate nohighlight">\(k/\delta^D\)</span></p>
<p><span class="math notranslate nohighlight">\([j/\delta^D]\)</span></p>
</td>
</tr>
<tr class="row-even"><td><p>Pick <span class="math notranslate nohighlight">\(x_n\)</span> in k positions.</p>
<p>[Pick <span class="math notranslate nohighlight">\(x_o\)</span> in j positions.]</p>
</td>
<td><p><span class="math notranslate nohighlight">\(P_k\)</span></p>
<p><span class="math notranslate nohighlight">\(P_j\)</span></p>
</td>
</tr>
<tr class="row-odd"><td><p>Accept</p>
<p>[Accept]</p>
</td>
<td><p><span class="math notranslate nohighlight">\(\min(1, \chi)\)</span></p>
<p><span class="math notranslate nohighlight">\([\min(1, 1/\chi)]\)</span></p>
</td>
</tr>
</tbody>
</table>
<p>Applying (local) detailed balance yields</p>
<p><span class="math notranslate nohighlight">\(\chi = \frac{P_j}{P_k} \exp[-\beta(U_n - U_o)]\)</span></p>
<p>Note that the number of new and old positions must be equal, <span class="math notranslate nohighlight">\(j = k\)</span>.
In this case, the j and k indices are retained to distinguish between positions
generated about the old or new position.</p>
<p>If the probability of picking a position is chosen as the typical Rosenbluth factor,</p>
<p><span class="math notranslate nohighlight">\(P_m = \exp(-\beta U)/\sum_i^m \exp(-\beta U_i)\)</span>.</p>
<p>Thus, the acceptance is given by</p>
<p><span class="math notranslate nohighlight">\(\chi = \frac{\sum_i^k \exp(-\beta U_i)}{\exp(-\beta U_n)}\frac{\exp(-\beta U_o)}{\sum_i^j \exp(-\beta U_i)}\exp(-\beta(U_n - U_o))\)</span></p>
<p><span class="math notranslate nohighlight">\(\chi = \frac{\sum_i^k \exp(-\beta U_i)}{\sum_i^j \exp(-\beta U_i)}\)</span>.</p>
<p>Note that the sum over j is for randomly generated positions within <span class="math notranslate nohighlight">\(\delta\)</span> of the new position,
while the sum over k is for randomly generated positions within <span class="math notranslate nohighlight">\(\delta\)</span> of the old position.
This means that the sum over j includes the old position.</p>
<p>For dual-cut configurational bias, the new trials are instead chosen from a
reference potential, <span class="math notranslate nohighlight">\(U^r\)</span>, that is ideally much faster to compute than
the full potential but still contains sampling-relevant terms (e.g., excluded
volume in a dense system).</p>
<p><span class="math notranslate nohighlight">\(P_m(U) = \exp(-\beta U^r)/\sum_i^m \exp(-\beta U_i^r)\)</span></p>
<p><span class="math notranslate nohighlight">\(\chi = \frac{\sum_i^k \exp(-\beta U^r_i)}{\sum_i^j \exp(-\beta U_i^r)}\exp\{-\beta[(U_n-U_n^r) - (U_o-U_o^r)]\}\)</span></p>
<p>Note that these equations consider only a single-site particle.</p>
</p>
<p><img alt="../../../_images/dccb_draw.png" src="../../../_images/dccb_draw.png" /></p>
<p>Subclassed by <a class="reference internal" href="../../cluster/doc/ComputeAVB2_arguments.html#classfeasst_1_1ComputeAVB2"><span class="std std-ref">feasst::ComputeAVB2</span></a>, <a class="reference internal" href="../../cluster/doc/ComputeAVB4_arguments.html#classfeasst_1_1ComputeAVB4"><span class="std std-ref">feasst::ComputeAVB4</span></a></p>
</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  


  <br></br>
  <footer class="nist-footer">
  <div class="nist-footer__inner">
    <div class="nist-footer__menu" role="navigation">
      <ul>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/privacy-policy">Privacy Statement</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/privacy-policy#privpolicy">Privacy Policy</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/privacy-policy#secnot">Security Notice</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/privacy-policy#accesstate">Accessibility Statement</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/privacy">NIST Privacy Program</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/no-fear-act-policy">No Fear Act Policy</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/disclaimer">Disclaimer</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/office-director/freedom-information-act">FOIA</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/environmental-policy-statement">Environmental Policy Statement</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.nist.gov/privacy-policy#cookie">Cookie Disclaimer</a>
        </li>
        <li class="nist-footer__menu-item ">
          <a href="https://www.nist.gov/summary-report-scientific-integrity">Scientific Integrity Summary</a>
        </li>
        <li class="nist-footer__menu-item ">
          <a href="https://www.nist.gov/nist-information-quality-standards">NIST Information Quality Standards</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://business.usa.gov/">Business USA</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.commerce.gov/">Commerce.gov</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="https://www.healthcare.gov/">Healthcare.gov</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="http://www.science.gov/">Science.gov</a>
        </li>
        <li class="nist-footer__menu-item">
          <a href="http://www.usa.gov/">USA.gov</a>
        </li>
      </ul>
    </div>
  </div>
  <div class="nist-footer__logo">
    <a href="https://www.nist.gov/" title="National Institute of Standards and Technology" class="nist-footer__logo-link" rel="home">
      <img src="https://pages.nist.gov/nist-header-footer/images/nist_logo_centered_rev.svg" alt="National Institute of Standards and Technology logo" />
    </a>
  </div>
</footer>

  <!-- Global site tag (gtag.js) - Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-115121490-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-115121490-6');
  </script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-WN56CL762L"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-WN56CL762L');
  </script>




</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>